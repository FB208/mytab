# 二级文件夹拖拽功能实现

## 功能描述
实现了二级文件夹在一级文件夹之间的拖拽移动功能，仿照书签拖拽的逻辑。

## 实现的功能
1. **二级文件夹拖拽**：可以将二级文件夹从一个一级文件夹拖拽到另一个一级文件夹
2. **拖拽限制**：二级文件夹不能拖拽到其他二级文件夹内
3. **状态管理**：拖拽时正确处理选中状态的变化
4. **视觉反馈**：提供适当的拖拽视觉反馈

## 修改的文件

### 1. `mytab/scripts/storage.js`
- 添加了 `moveSubfolder` 函数，用于在数据层面移动子文件夹
- 函数参数：
  - `sourceParentId`: 源一级文件夹ID
  - `subId`: 要移动的子文件夹ID  
  - `targetParentId`: 目标一级文件夹ID

### 2. `mytab/scripts/app.js`
- 导入了 `moveSubfolder` 函数
- 添加了全局 `dragState` 对象来跟踪拖拽状态
- 为二级文件夹添加了拖拽事件监听器：
  - `dragstart`: 设置拖拽数据和状态
  - `dragend`: 清理拖拽状态
- 更新了一级文件夹的 `drop` 事件处理，支持接收二级文件夹
- 更新了二级文件夹的 `dragover` 事件，防止子文件夹拖拽到子文件夹

## 拖拽逻辑

### 拖拽开始 (dragstart)
1. 设置全局 `dragState.type` 为 'subfolder'
2. 设置 `dragState.data` 为子文件夹ID
3. 设置 `dataTransfer` 数据为 `subfolder:${subId}`

### 拖拽悬停 (dragover)
1. 检查 `dragState.type` 来决定是否允许放置
2. 子文件夹只能拖拽到一级文件夹，不能拖拽到其他子文件夹

### 拖拽放置 (drop)
1. 解析拖拽数据，判断是书签还是子文件夹
2. 如果是子文件夹，调用 `moveSubfolder` 函数
3. 更新UI状态，如果当前选中的是被移动的子文件夹，则清除选中状态

### 拖拽结束 (dragend)
1. 清理全局 `dragState` 状态

## 使用方法
1. 在一级文件夹中，二级文件夹显示为卡片形式
2. 直接拖拽二级文件夹卡片到左侧的一级文件夹列表
3. 也可以在子文件夹列表中拖拽子文件夹项到一级文件夹

## 注意事项
- 子文件夹不能拖拽到自己当前所在的一级文件夹
- 子文件夹不能拖拽到其他子文件夹内
- 拖拽完成后会自动更新UI和数据存储
- 如果当前选中的子文件夹被移动，会自动清除选中状态